<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>RSI Admin â€¢ Vessel Configuration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Libs -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />

  <!-- Ripple + Admin CSS -->
  <link href="../assets/ripple.css" rel="stylesheet" />
  <link href="admin-page.css" rel="stylesheet" />
</head>

<body>
   <button type="button" id="sidebar-toggle" class="mobile-toggle">
        <i class="fa fa-bars"></i>
    </button>
    <div class="container-fluid dashboard-layout">
        <div class="row">
            <!-- Sidebar -->
            <div id="sidebar-placeholder" class="col-sm-3 col-md-2 sidebar"></div>
      <!-- Main -->
      <div class="col-sm-9 col-md-10 main-content">
        <div class="page-header">
          <h2>Vessel Configuration</h2>
          <p>Register, manage, and configure vessels</p>
        </div>

        <!-- Overview of Vessels -->
        <div class="panel">
          <div class="panel-heading">
            <i class="fa fa-list"></i> All Vessels
            <button class="btn btn-primary btn-sm pull-right" data-toggle="collapse" data-target="#addVesselForm">
              <i class="fa fa-plus"></i> Add Vessel
            </button>
          </div>
          <div class="panel-body">
            <div class="form-inline m-b-15">
              <label for="companyFilter">Filter by Company:</label>
              <select id="companyFilter" class="form-control select2" style="min-width:240px;">
                <option value="">All Companies</option>
                <option>Ripple Marine</option>
                <option>Oceanic Lines</option>
              </select>
            </div>
            <table class="table table-bordered table-striped">
              <thead>
                <tr>
                  <th>IMO</th>
                  <th>Vessel Name</th>
                  <th>Type</th>
                  <th>Company</th>
                  <th>License Expiry</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="vesselList">
                <tr>
                  <td>IMO1234567</td>
                  <td>MV Ocean Star</td>
                  <td>Cargo</td>
                  <td>Ripple Marine</td>
                  <td>2026-02-10</td>
                  <td>
                    <button class="btn btn-xs btn-default edit-btn"><i class="fa fa-pencil"></i></button>
                    <button class="btn btn-xs btn-danger delete-btn"><i class="fa fa-trash"></i></button>
                  </td>
                </tr>
                <tr>
                  <td>IMO9876543</td>
                  <td>MV Golden Wave</td>
                  <td>Tanker</td>
                  <td>Oceanic Lines</td>
                  <td>2025-11-01</td>
                  <td>
                    <button class="btn btn-xs btn-default edit-btn"><i class="fa fa-pencil"></i></button>
                    <button class="btn btn-xs btn-danger delete-btn"><i class="fa fa-trash"></i></button>
                  </td>
                </tr>
              </tbody>
            </table>

            <!-- Collapsible Add/Edit Vessel Form -->
            <div id="addVesselForm" class="collapse">
              <hr />
              <h4><i class="fa fa-plus-circle"></i> Register New Vessel</h4>
              <div id="saveAlert" class="alert alert-success" style="margin-top:15px; display:none;">
                <i class="fa fa-check-circle"></i> Vessel added successfully!
              </div>
              <div class="row">
                <div class="col-sm-4 form-group">
                  <label>IMO Number</label>
                  <input type="text" class="form-control" id="imoInput" placeholder="e.g., 1234567">
                </div>
                <div class="col-sm-4 form-group">
                  <label>Vessel Name</label>
                  <input type="text" class="form-control" id="nameInput">
                </div>
                <div class="col-sm-4 form-group">
                  <label>Vessel Type</label>
                  <input type="text" class="form-control" id="typeInput">
                </div>
              </div>
              <div class="row">
                <div class="col-sm-6 form-group">
                  <label>Company</label>
                  <input type="text" class="form-control" id="companyInput">
                </div>
                <div class="col-sm-6 form-group">
                  <label>License Expiry Date</label>
                  <input type="date" class="form-control" id="expiryInput">
                </div>
              </div>
              <button id="saveVessel" class="btn btn-primary">
                <i class="fa fa-save"></i> Save Vessel
              </button>
              <button class="btn btn-default" data-toggle="collapse" data-target="#addVesselForm">
                <i class="fa fa-times"></i> Close Form
              </button>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.full.min.js"></script>
  <script>
    $(function () {
       $('#sidebar-toggle').on('click', function () {
        $('.sidebar').toggleClass('active');
      });

     fetch('admin-sidebar.html')
      .then(response => response.text())
      .then(data => {
        const sidebarPlaceholder = document.getElementById('sidebar-placeholder');
        sidebarPlaceholder.innerHTML = data;
        const currentPage = 'admin-vessel-setup';
        const activeLink = sidebarPlaceholder.querySelector(`[data-page="${currentPage}"]`);
        if (activeLink) {
          activeLink.classList.add('active');
        }
      })
      .catch(error => console.error('Error fetching sidebar:', error));

      $('.select2').select2();

      let editMode = null; // track row being edited

      // Filter (demo)
      $('#companyFilter').on('change', function () {
        alert('Filter vessels by company (demo)');
      });

      // Save Vessel
      $('#saveVessel').on('click', function () {
        const imo = $('#imoInput').val().trim();
        const name = $('#nameInput').val().trim();
        const type = $('#typeInput').val().trim();
        const company = $('#companyInput').val().trim();
        const expiry = $('#expiryInput').val();

        if (!imo || !name || !type || !company || !expiry) {
          alert('Please fill in all fields before saving.');
          return;
        }

        if (editMode) {
          // ðŸ”„ Update existing row
          editMode.find('td:eq(0)').text(imo);
          editMode.find('td:eq(1)').text(name);
          editMode.find('td:eq(2)').text(type);
          editMode.find('td:eq(3)').text(company);
          editMode.find('td:eq(4)').text(expiry);

          editMode = null; // reset edit mode
          $('#saveVessel').html('<i class="fa fa-save"></i> Save Vessel')
            .removeClass('btn-info')
            .addClass('btn-success');
        } else {
          // âž• Add new row
          const row = `
        <tr>
          <td>${imo}</td>
          <td>${name}</td>
          <td>${type}</td>
          <td>${company}</td>
          <td>${expiry}</td>
          <td>
            <button class="btn btn-xs btn-default edit-btn"><i class="fa fa-pencil"></i></button>
            <button class="btn btn-xs btn-danger delete-btn"><i class="fa fa-trash"></i></button>
          </td>
        </tr>
      `;
          $('#vesselList').append(row);
        }

        // Show success alert
        $('#saveAlert').fadeIn().delay(2000).fadeOut();

        // Clear form
        $('#imoInput, #nameInput, #typeInput, #companyInput, #expiryInput').val('');
      });

      // Delete Vessel
      $('#vesselList').on('click', '.delete-btn', function () {
        if (confirm('Are you sure you want to delete this vessel?')) {
          $(this).closest('tr').remove();
        }
      });

      // Edit Vessel
      $('#vesselList').on('click', '.edit-btn', function () {
        editMode = $(this).closest('tr'); // store the row
        $('#imoInput').val(editMode.find('td:eq(0)').text());
        $('#nameInput').val(editMode.find('td:eq(1)').text());
        $('#typeInput').val(editMode.find('td:eq(2)').text());
        $('#companyInput').val(editMode.find('td:eq(3)').text());
        $('#expiryInput').val(editMode.find('td:eq(4)').text());

        // Change button to Update
        $('#saveVessel').html('<i class="fa fa-check"></i> Update Vessel')
          .removeClass('btn-success')
          .addClass('btn-info');

        $('#addVesselForm').collapse('show');
      });
    });
  </script>
</body>

</html>