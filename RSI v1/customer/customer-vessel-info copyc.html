<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>RSI Customer â€¢ Vessel Info</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Libs -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />

  <!-- Summernote (Rich Text Editor) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote.min.css" rel="stylesheet" />

  <!-- Ripple + Customer CSS -->
  <link href="../assets/ripple.css" rel="stylesheet" />
  <link href="page.css" rel="stylesheet" />
  <style>
    /* About preview fixed height + scroll */
    #aboutPreview {
      height: 300px;
      /* max-height: 335px; */
      overflow-y: auto;
    }

    /* Vessel gallery fixed height */
    .vessel-carousel {
      height: 300px;
      overflow: hidden;
    }

    .vessel-carousel img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 6px;
    }
  </style>
</head>

<body>
  <div class="container-fluid dashboard-layout">
    <div class="row">
      <!-- Sidebar -->
      <div id="sidebar-placeholder"></div>

      <!-- Main -->
      <div class="col-sm-9 col-md-10 main-content">
        <div class="page-header">
          <h2>Vessel Configuration</h2>
          <p>Maintain vessel details to ensure accurate information is displayed in the crew portal.</p>
        </div>

        <!-- Vessel Info -->
        <div class="panel">
          <div class="panel-heading">
            <i class="fa fa-ship"></i> M/V Yurisan Dozo
            <button class="btn btn-primary btn-sm pull-right" data-toggle="collapse" data-target="#vesselInfoForm">
              <i class="fa fa-pencil"></i> Add/Edit Info
            </button>
          </div>
          <div class="panel-body">

            <!-- Edit Form -->
            <div id="vesselInfoForm" class="collapse">
              <form id="vesselForm">
                <div class="form-group">
                  <label>About the Vessel</label>
                  <textarea id="aboutVessel" class="form-control rich-text"></textarea>
                </div>
                <div class="form-group">
                  <label>Upload Vessel Photos (Max 5)</label>
                  <input type="file" id="vesselPhotos" class="form-control" accept="image/*" multiple />
                  <p class="help-block">Upload up to 5 images. Recommended size: 800x500px</p>
                </div>
                <button type="submit" class="btn btn-success">
                  <i class="fa fa-save"></i> Save
                </button>
              </form>
              <hr />
            </div>

            <!-- Preview Section -->
            <div class="row">
              <!-- About Vessel -->
              <div class="col-md-6">
                <h4><i class="fa fa-info-circle"></i> About the Vessel</h4>
                <div id="aboutPreview" class="well">
                  <p>No information added yet. Click <b>Add/Edit Info</b> to update.</p>
                </div>
              </div>

              <!-- Vessel Photos -->
              <div class="col-md-6">
                <h4><i class="fa fa-picture-o"></i> Vessel Gallery</h4>
                <div id="vesselCarousel" class="carousel slide vessel-carousel" data-ride="carousel">
                  <div class="carousel-inner">
                    <div class="item active">
                      <img
                        src="https://t4.ftcdn.net/jpg/01/73/99/53/360_F_173995335_j0eNa99Jd3PvFxUDHf9mqwxFSG4T04Ja.jpg" />
                    </div>
                    <div class="item">
                      <img src="https://static.vecteezy.com/system/resources/thumbnails/002/305/012/small_2x/aerial-top-view-of-large-container-cargo-ship-photo.jpg" />
                    </div>
                    <div class="item">
                      <img src="https://plus.unsplash.com/premium_photo-1661879449050-069f67e200bd?fm=jpg&q=60&w=3000&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8c2hpcHBpbmd8ZW58MHx8MHx8fDA%3D" />
                    </div>
                    <div class="item">
                      <img src="https://img.freepik.com/free-photo/aerial-view-cargo-ship-with-cargo-container-sea_335224-1372.jpg" />
                    </div>
                    <div class="item">
                      <img src="https://media.istockphoto.com/id/1418267688/photo/aerial-top-down-view-of-a-large-container-cargo-ship-with-copy-space.jpg?s=612x612&w=0&k=20&c=yp2Y2BxdYy5z4mpKT8fRc1uTf-ocJVNlGjjPNEo7jSM=" />
                    </div>
                  </div>
                  <!-- Controls -->
                  <a class="left carousel-control" href="#vesselCarousel" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                  </a>
                  <a class="right carousel-control" href="#vesselCarousel" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right"></span>
                  </a>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- Activity Logs Config -->
        <div class="panel">
          <div class="panel-heading">
            <i class="fa fa-history"></i> Configure Activity Logs/History
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-sm-4 form-group">
                <label>Number of logs to display</label>
                <input type="number" id="logCount" class="form-control" min="1" max="20" value="5">
              </div>
              <div class="col-sm-8 form-group">
                <label>Columns to display</label>
                <select id="logColumns" class="form-control select2" multiple>
                  <option value="activity" selected>Activity</option>
                  <option value="vessel">Vessel</option>
                  <option value="embark">Embark Date</option>
                  <option value="disembark">Disembark Date</option>
                  <option value="location">Location</option>
                </select>
              </div>
            </div>
            <button class="btn btn-success"><i class="fa fa-save"></i> Save Logs Config</button>
            <hr />

            <!-- Preview Table -->
            <h4>Preview (Client Portal)</h4>
            <table class="table table-bordered" id="logsPreview">
              <thead>
                <tr></tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="4" class="text-center text-muted">Sample activity logs will appear here</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

      </div><!-- /main -->
    </div>
  </div>

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.full.min.js"></script>
  <!-- Summernote -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote.min.js"></script>

  <script>
    $(function () {
      $('.select2').select2();

      // Sidebar load
      fetch('customer-sidebar.html')
        .then(response => response.text())
        .then(data => {
          const sidebarPlaceholder = document.getElementById('sidebar-placeholder');
          sidebarPlaceholder.innerHTML = data;

          const currentPage = 'customer-vessel-info';
          const activeLink = sidebarPlaceholder.querySelector(`[data-page="${currentPage}"]`);
          if (activeLink) {
            activeLink.classList.add('active');
          }
        });

      // Sample placeholder text
      const placeholderText = `
      <p><b>About the Vessel: M/V Yurisan Dozo</b></p>
      <p>The M/V Yurisan Dozo is a state-of-the-art cargo and passenger vessel designed 
      for efficiency, comfort, and safety at sea. Built with advanced navigation systems 
      and modern facilities, it serves both regional and international routes. 
      The vessel is known for its fuel efficiency, spacious cabins, and reliable 
      performance under varying weather conditions.</p>
      <p>Onboard amenities include crew accommodations, passenger lounges, 
      and a fully equipped bridge. The M/V Yurisan Dozo reflects the latest standards 
      in maritime engineering, offering a balance between functionality and 
      sustainability in ocean travel.</p>
      <p>Key Specifications:</p>
      <ul>
        <li>Length: 150 meters</li>
        <li>Beam: 25 meters</li>
        <li>Gross Tonnage: 20,000 GT</li>
        <li>Passenger Capacity: 200</li>
        <li>Crew Capacity: 50</li>
        <li>Maximum Speed: 22 knots</li>
        <li>Year Built: 2020</li>
        <li>Flag: Panama</li>
      </ul>
      <p><i>Note: This is sample text. Please update with actual vessel information.</i></p>

    `;

      // Init rich text editor
      $('#aboutVessel').summernote({
        height: 150,
        placeholder: 'Describe your vessel here...'
      });

      // Fill preview with placeholder initially
      $('#aboutPreview').html(placeholderText);

      // When Edit button is clicked, load current preview into editor
      $('[data-target="#vesselInfoForm"]').on('click', function () {
        const currentHtml = $('#aboutPreview').html().trim();
        if (currentHtml) {
          $('#aboutVessel').summernote('code', currentHtml);
        } else {
          $('#aboutVessel').summernote('code', placeholderText);
        }
      });

      // Form submit handler
      $('#vesselForm').on('submit', function (e) {
        e.preventDefault();

        // Update About Preview
        const aboutHtml = $('#aboutVessel').summernote('code');
        $('#aboutPreview').html(aboutHtml || placeholderText);

        // Update Carousel with photos
        const files = $('#vesselPhotos')[0].files;
        const carouselInner = $('#vesselCarousel .carousel-inner');
        carouselInner.empty();

        if (files.length > 0) {
          Array.from(files).slice(0, 5).forEach((file, i) => {
            const reader = new FileReader();
            reader.onload = function (e) {
              const active = i === 0 ? 'active' : '';
              const img = `
              <div class="item ${active}">
                <img src="${e.target.result}" />
              </div>`;
              carouselInner.append(img);
            };
            reader.readAsDataURL(file);
          });
        } else {
          carouselInner.html(`
          <div class="item active">
            <img src="https://t4.ftcdn.net/jpg/01/73/99/53/360_F_173995335_j0eNa99Jd3PvFxUDHf9mqwxFSG4T04Ja.jpg" />
          </div>
        `);
        }
      });
    });
  </script>
  <script>
    $(function () {
      // Logs Preview
      function updateLogsPreview() {
        const cols = $('#logColumns').val();
        const headRow = $('#logsPreview thead tr').empty();
        if (!cols || cols.length === 0) {
          headRow.append('<th>No columns selected</th>');
          $('#logsPreview tbody').html('<tr><td class="text-muted text-center">No data</td></tr>');
          return;
        }
        cols.forEach(col => {
          const label = col.charAt(0).toUpperCase() + col.slice(1);
          headRow.append(`<th>${label.replace(/([A-Z])/g, ' $1').trim()}</th>`);
        });
        const sample = Array.from({ length: $('#logCount').val() || 5 }, (_, i) =>
          `<tr>${cols.map(c => `<td>Sample ${c} ${i + 1}</td>`).join('')}</tr>`
        ).join('');
        $('#logsPreview tbody').html(sample);
      }

      $('#logColumns, #logCount').on('change input', updateLogsPreview);
      updateLogsPreview();
    });
  </script>
</body>

</html>