<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>RSI Customer â€¢ Vessel Info</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Libs -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />

  <!-- Summernote (Rich Text Editor) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote.min.css" rel="stylesheet" />

  <!-- Ripple + Customer CSS -->
  <link href="../assets/ripple.css" rel="stylesheet" />
  <link href="page.css" rel="stylesheet" />
  <style>
    .vessel-carousel img {
      width: 100%;
      height: 300px;
      object-fit: cover;
      border-radius: 6px;
    }
  </style>
</head>

<body>
  <div class="container-fluid dashboard-layout">
    <div class="row">
      <!-- Sidebar -->
      <div id="sidebar-placeholder"></div>

      <!-- Main -->
      <div class="col-sm-9 col-md-10 main-content">
        <div class="page-header">
          <h2>Vessel Configuration</h2>
          <p>Setup vessel information and configure how it will appear in the Client Portal.</p>
        </div>

        <!-- Vessel Info -->
        <div class="panel">
          <div class="panel-heading">
            <i class="fa fa-ship"></i> M/V Yurisan Dozo
            <button class="btn btn-primary btn-sm pull-right" data-toggle="collapse" data-target="#vesselInfoForm">
              <i class="fa fa-pencil"></i> Add/Edit Info
            </button>
          </div>
          <div class="panel-body">

            <!-- Edit Form -->
            <div id="vesselInfoForm" class="collapse">
              <form id="vesselForm">
                <div class="form-group">
                  <label>About the Vessel</label>
                  <textarea id="aboutVessel" class="form-control rich-text"></textarea>
                </div>
                <div class="form-group">
                  <label>Upload Vessel Photos (Max 5)</label>
                  <input type="file" id="vesselPhotos" class="form-control" accept="image/*" multiple />
                  <p class="help-block">Upload up to 5 images. Recommended size: 800x500px</p>
                </div>
                <button type="submit" class="btn btn-success">
                  <i class="fa fa-save"></i> Save
                </button>
              </form>
              <hr />
            </div>

            <!-- Preview Section -->
            <div class="row">
              <!-- About Vessel -->
              <div class="col-md-6">
                <h4><i class="fa fa-info-circle"></i> About the Vessel</h4>
                <div id="aboutPreview" class="well">
                  <p>No information added yet. Click <b>Add/Edit Info</b> to update.</p>
                </div>
              </div>

              <!-- Vessel Photos -->
              <div class="col-md-6">
                <h4><i class="fa fa-picture-o"></i> Vessel Gallery</h4>
                <div id="vesselCarousel" class="carousel slide vessel-carousel" data-ride="carousel">
                  <div class="carousel-inner">
                    <div class="item active">
                      <img src="https://via.placeholder.com/800x500?text=No+Photo" />
                    </div>
                  </div>
                  <!-- Controls -->
                  <a class="left carousel-control" href="#vesselCarousel" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                  </a>
                  <a class="right carousel-control" href="#vesselCarousel" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right"></span>
                  </a>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- Activity Logs Config -->
        <div class="panel">
          <div class="panel-heading">
            <i class="fa fa-history"></i> Configure Activity Logs/History
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-sm-4 form-group">
                <label>Number of logs to display</label>
                <input type="number" id="logCount" class="form-control" min="1" max="20" value="5">
              </div>
              <div class="col-sm-8 form-group">
                <label>Columns to display</label>
                <select id="logColumns" class="form-control select2" multiple>
                  <option value="activity" selected>Activity</option>
                  <option value="vessel">Vessel</option>
                  <option value="embark">Embark Date</option>
                  <option value="disembark">Disembark Date</option>
                  <option value="location">Location</option>
                </select>
              </div>
            </div>
            <button class="btn btn-success"><i class="fa fa-save"></i> Save Logs Config</button>
            <hr />

            <!-- Preview Table -->
            <h4>Preview (Client Portal)</h4>
            <table class="table table-bordered" id="logsPreview">
              <thead><tr></tr></thead>
              <tbody>
                <tr><td colspan="4" class="text-center text-muted">Sample activity logs will appear here</td></tr>
              </tbody>
            </table>
          </div>
        </div>

      </div><!-- /main -->
    </div>
  </div>

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.full.min.js"></script>
  <!-- Summernote -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote.min.js"></script>

  <script>
    $(function () {
      // Sidebar load
      fetch('customer-sidebar.html')
        .then(response => response.text())
        .then(data => {
          const sidebarPlaceholder = document.getElementById('sidebar-placeholder');
          sidebarPlaceholder.innerHTML = data;

          const currentPage = 'customer-vessel-info';
          const activeLink = sidebarPlaceholder.querySelector(`[data-page="${currentPage}"]`);
          if (activeLink) {
            activeLink.classList.add('active');
          }
        });
      // Init rich text editor
      $('#aboutVessel').summernote({
        height: 150,
        placeholder: 'Describe your vessel here...'
      });

      // Form submit handler
      $('#vesselForm').on('submit', function (e) {
        e.preventDefault();

        // Update About Preview
        const aboutHtml = $('#aboutVessel').summernote('code');
        $('#aboutPreview').html(aboutHtml || "<p>No info provided yet.</p>");

        // Update Carousel with photos
        const files = $('#vesselPhotos')[0].files;
        const carouselInner = $('#vesselCarousel .carousel-inner');
        carouselInner.empty();

        if (files.length > 0) {
          Array.from(files).slice(0, 5).forEach((file, i) => {
            const reader = new FileReader();
            reader.onload = function (e) {
              const active = i === 0 ? 'active' : '';
              const img = `
                <div class="item ${active}">
                  <img src="${e.target.result}" />
                </div>`;
              carouselInner.append(img);
            };
            reader.readAsDataURL(file);
          });
        } else {
          carouselInner.html(`
            <div class="item active">
              <img src="https://via.placeholder.com/800x500?text=No+Photo" />
            </div>
          `);
        }
      });
    });
  </script>
  <script>
    $(function () {
      // Logs Preview
      function updateLogsPreview() {
        const cols = $('#logColumns').val();
        const headRow = $('#logsPreview thead tr').empty();
        if (!cols || cols.length === 0) {
          headRow.append('<th>No columns selected</th>');
          $('#logsPreview tbody').html('<tr><td class="text-muted text-center">No data</td></tr>');
          return;
        }
        cols.forEach(col => {
          const label = col.charAt(0).toUpperCase() + col.slice(1);
          headRow.append(`<th>${label.replace(/([A-Z])/g, ' $1').trim()}</th>`);
        });
        const sample = Array.from({ length: $('#logCount').val() || 5 }, (_, i) =>
          `<tr>${cols.map(c => `<td>Sample ${c} ${i + 1}</td>`).join('')}</tr>`
        ).join('');
        $('#logsPreview tbody').html(sample);
      }

      $('#logColumns, #logCount').on('change input', updateLogsPreview);
      updateLogsPreview();
    });
  </script>
</body>

</html>
