<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>RSI Customer â€¢ Vessel Setup</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Libs -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />

    <!-- Ripple + Admin CSS -->
    <link href="../assets/ripple.css" rel="stylesheet" />
    <link href="page.css" rel="stylesheet" />
</head>

<body>
    <div class="container-fluid dashboard-layout">
        <div class="row">
            <!-- Sidebar -->
            <div id="sidebar-placeholder"></div>
            <!-- Main -->
            <div class="col-sm-9 col-md-10 main-content">
                <div class="page-header">
                    <h2>Certificates Configuration</h2>
                    <p>Define which certificates are required from crew during registration.</p>
                </div>

                <!-- Certificates -->
                <div class="tab-pane" id="certificates">
                    <div class="col-sm-12">
                        <!-- <div class="panel-body"> -->
                            <h3>82% <small>storage used</small> <i class="fa fa-info-circle small" data-toggle="tooltip" title="You have used 82% of your storage quota."></i></h3>
                            <div class="progress">
                                <div class="progress-bar progress-bar-info" style="width:82%"></div>
                            </div>
                        <!-- </div> -->
                    </div>
                    <div class="panel">
                        <div class="panel-heading">
                            <i class="fa fa-list"></i> Add Certificate
                            <button class="btn btn-primary btn-xs pull-right" data-toggle="modal"
                                data-target="#modalCert">
                                <i class="fa fa-plus"></i> Add Certificate
                            </button>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label>General Instructions (displayed above the table)</label>
                                <textarea id="certInstructions" class="form-control" rows="3"
                                    placeholder="e.g., Please upload clear, readable copies."></textarea>
                            </div>

                            <table class="table table-bordered" id="certTable">
                                <thead>
                                    <tr>
                                        <th style="width: 20%">Name (crew sees)</th>
                                        <th style="width: 12%">Type</th>
                                        <th style="width: 12%">Code</th>
                                        <th style="width: 14%">Category</th>
                                        <th>Description</th>
                                        <th style="width: 9%">Required</th>
                                        <th style="width: 9%">Upload</th>
                                        <th style="width: 12%">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Seaman's Book</td>
                                        <td><span class="label label-gray">Document</span></td>
                                        <td>SBK-01</td>
                                        <td><span class="label label-light">Identity</span></td>
                                        <td>Official seafarer identification booklet.</td>
                                        <td><span class="label label-red">Yes</span></td>
                                        <td><span class="label label-blue">Yes</span></td>
                                        <td>
                                            <button class="btn btn-xs btn-default edit-cert">
                                                <i class="fa fa-pencil"></i>
                                            </button>
                                            <button class="btn btn-xs btn-danger delete-cert">
                                                <i class="fa fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Medical Certificate</td>
                                        <td><span class="label label-gray">Medical</span></td>
                                        <td>MED-11</td>
                                        <td><span class="label label-light">Health</span></td>
                                        <td>Medical fitness for duty.</td>
                                        <td><span class="label label-red">Yes</span></td>
                                        <td><span class="label label-gray">No</span></td>
                                        <td>
                                            <button class="btn btn-xs btn-default edit-cert">
                                                <i class="fa fa-pencil"></i>
                                            </button>
                                            <button class="btn btn-xs btn-danger delete-cert">
                                                <i class="fa fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <hr />
                            <button id="saveChanges" class="btn btn-primary"><i class="fa fa-save"></i> Save
                                Changes</button>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Certificate Modal -->
        <div class="modal fade" id="modalCert" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form>
                        <div class="modal-header">
                            <h4 class="modal-title">Add Certificate Requirement</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Certificate Name</label>
                                <input type="text" class="form-control"
                                    placeholder="Example: Certificate of Proficiency in Survival Craft">
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select class="form-control">
                                    <option>Safety</option>
                                    <option>Medical</option>
                                    <option>Training</option>
                                </select>
                            </div>

                            <div class="form-grid columns-2">
                                <div class="form-group">
                                    <label>Type</label>
                                    <input type="text" class="form-control" placeholder=" Example: STCW Certificate">
                                </div>

                                <div class="form-group">
                                    <label>Code</label>
                                    <input type="text" class="form-control" placeholder=" Example: STCW A-VI/2">
                                </div>
                                <div class="form-group">
                                    <label>Allowed File Type</label>
                                    <select class="form-control">
                                        <option>PDF</option>
                                        <option>Image</option>
                                        <option>Word/Doc</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Max File Size (MB)</label>
                                    <input type="number" class="form-control" value="5">
                                </div>

                            </div>
                            <div class="checkbox"><label><input type="checkbox" checked> Required Document</label></div>
                            <div class="checkbox"><label><input type="checkbox" checked> Required to Upload</label>
                            </div>

                            <div class="form-group">
                                <label>Description</label>
                                <textarea class="form-control" rows="2"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Instructions for Crew</label>
                                <textarea class="form-control" rows="3"></textarea>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Certificate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        
    </div>

    <!-- JS -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.full.min.js"></script>
    <script>
        $(function () {
            $('.select2').select2();

            fetch('customer-sidebar.html')
                .then(response => response.text())
                .then(data => {
                    const sidebarPlaceholder = document.getElementById('sidebar-placeholder');
                    sidebarPlaceholder.innerHTML = data;

                    // Script to set the active state after the sidebar is loaded
                    const currentPage = 'customer-certificates';
                    const activeLink = sidebarPlaceholder.querySelector(`[data-page="${currentPage}"]`);
                    if (activeLink) {
                        activeLink.classList.add('active');
                    }
                })
                .catch(error => console.error('Error fetching sidebar:', error));

            // Save
            $("#saveChanges").on("click", function () {
                alert("Save Certificates Config (demo)");
            });

        });


    </script>
    
    <script>
        // Certificates table â€” Add / Edit / Remove (demo only)
            function rowToObj($tr) {
                return {
                    name: $tr.children().eq(0).text().trim(),
                    type: $tr.find("td:eq(1) .label").text().trim(),
                    code: $tr.children().eq(2).text().trim(),
                    category: $tr.find("td:eq(3) .label").text().trim(),
                    desc: $tr.children().eq(4).text().trim(),
                    isRequired: $tr.find("td:eq(5) .label").text().trim() === "Yes",
                    requireUpload: $tr.find("td:eq(6) .label").text().trim() === "Yes",
                };
            }

            function objToRow(o) {
                return `
          <tr>
            <td>${o.name}</td>
            <td><span class="label label-gray">${o.type || "-"}</span></td>
            <td>${o.code || "-"}</td>
            <td><span class="label label-light">${o.category || "-"}</span></td>
            <td>${o.desc || "-"}</td>
            <td><span class="label ${o.isRequired ? "label-red" : "label-gray"
                    }">${o.isRequired ? "Yes" : "No"}</span></td>
            <td><span class="label ${o.requireUpload ? "label-blue" : "label-gray"
                    }">${o.requireUpload ? "Yes" : "No"}</span></td>
            <td>
              <button class="btn btn-xs btn-default edit-cert"><i class="fa fa-pencil"></i></button>
              <button class="btn btn-xs btn-danger delete-cert"><i class="fa fa-trash"></i></button>
            </td>
          </tr>`;
            }

            // Submit
            $("#formCert").on("submit", function (e) {
                e.preventDefault();
                const idx = $("#certRowIndex").val();
                const o = {
                    name: $("#certName").val(),
                    type: $("#certType").val(),
                    code: $("#certCode").val(),
                    category: $("#certCategory").val(),
                    desc: $("#certDesc").val(),
                    isRequired: $("#certIsRequired").prop("checked"),
                    requireUpload: $("#certRequireUpload").prop("checked"),
                };
                if (idx === "") {
                    $("#certTable tbody").append(objToRow(o));
                } else {
                    const $tr = $("#certTable tbody tr").eq(parseInt(idx, 10));
                    $tr.replaceWith(objToRow(o));
                }
                $("#modalCert").modal("hide");
                this.reset();
                $("#certRowIndex").val("");
            });

            // Edit
            $(document).on("click", ".edit-cert", function () {
                const $tr = $(this).closest("tr");
                const i = $tr.index();
                const o = rowToObj($tr);
                $("#certRowIndex").val(i);
                $("#certName").val(o.name);
                $("#certType").val(o.type);
                $("#certCode").val(o.code);
                $("#certCategory").val(o.category);
                $("#certDesc").val(o.desc);
                $("#certIsRequired").prop("checked", o.isRequired);
                $("#certRequireUpload").prop("checked", o.requireUpload);
                $("#modalCert").modal("show");
            });

            // Delete
            $(document).on("click", ".delete-cert", function () {
                if (confirm("Delete this certificate template?"))
                    $(this).closest("tr").remove();
            });

            // Save upload rules (demo)
            $("#saveRules").on("click", function () {
                alert("File type & size rules saved.");
            });
    </script>
</body>

</html>